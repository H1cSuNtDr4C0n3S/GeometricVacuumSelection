(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[      6354,        181]
NotebookOptionsPosition[      5164,        159]
NotebookOutlinePosition[      5478,        173]
CellTagsIndexPosition[      5435,        170]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["04 - Ratio Kernel Form", "Title",ExpressionUUID->"1c0bb86d-dfff-4645-82da-4688f5f71b22"],

Cell["\<\
Kernel form of the first variation of q = I1/I0 under metric perturbations.\
\>", "Text",ExpressionUUID->"f0aa5e52-ac98-40c1-b840-5b57cdea2c86"],

Cell[BoxData[
 TagBox[
  RowBox[{"q", "=", 
   FractionBox["I1", "I0"]}],
  HoldForm]], "Input",ExpressionUUID->"680193be-553a-4c77-832e-dd1044d96b41"],

Cell[BoxData[
 TagBox[
  RowBox[{"deltaQ", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     FractionBox["dI1", "I0"], "-", 
     FractionBox[
      RowBox[{"I1", " ", "dI0"}], 
      SuperscriptBox["I0", "2"]]}], "]"}]}],
  HoldForm]], "Input",ExpressionUUID->"3358246c-0d6d-4f30-bd59-84bf195722a8"],

Cell[BoxData[
 TagBox[
  RowBox[{"rhs", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     FractionBox["dI1", "I0"], "-", 
     FractionBox[
      RowBox[{"q", " ", "dI0"}], "I0"]}], "]"}]}],
  HoldForm]], "Input",ExpressionUUID->"da2e4ddf-083a-48e9-b3af-4082954dccb8"],

Cell[BoxData[
 TagBox[
  RowBox[{"checkA", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"deltaQ", "\[Equal]", "rhs"}], "]"}]}],
  HoldForm]], "Input",ExpressionUUID->"755e3124-cb5b-4079-b331-135156394e98"],

Cell[BoxData[
 TagBox[
  RowBox[{"dI0", "=", 
   TemplateBox[{
     RowBox[{
       RowBox[{"k0", "[", "x", "]"}], " ", 
       RowBox[{"dg", "[", "x", "]"}]}], "x", "xmin", "xmax"},
    "InactiveIntegrate",
    DisplayFunction->(RowBox[{
       SubsuperscriptBox[
        StyleBox["\[Integral]", "Inactive"], #3, #4], 
       RowBox[{#, 
         RowBox[{
           StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
    InterpretationFunction->(RowBox[{
       RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
       RowBox[{#, ",", 
         RowBox[{"{", 
           RowBox[{#2, ",", #3, ",", #4}], "}"}]}], "]"}]& )]}],
  HoldForm]], "Input",ExpressionUUID->"a57e71a3-a83a-42c1-9535-ce34adf7cb0f"],

Cell[BoxData[
 TagBox[
  RowBox[{"dI1", "=", 
   TemplateBox[{
     RowBox[{
       RowBox[{"k1", "[", "x", "]"}], " ", 
       RowBox[{"dg", "[", "x", "]"}]}], "x", "xmin", "xmax"},
    "InactiveIntegrate",
    DisplayFunction->(RowBox[{
       SubsuperscriptBox[
        StyleBox["\[Integral]", "Inactive"], #3, #4], 
       RowBox[{#, 
         RowBox[{
           StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
    InterpretationFunction->(RowBox[{
       RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
       RowBox[{#, ",", 
         RowBox[{"{", 
           RowBox[{#2, ",", #3, ",", #4}], "}"}]}], "]"}]& )]}],
  HoldForm]], "Input",ExpressionUUID->"578559cd-9bf1-4d4e-8f8e-3684b5356ff0"],

Cell[BoxData[
 TagBox[
  RowBox[{"rhsKernel", "=", 
   RowBox[{"rhs", "/.", "\[VeryThinSpace]", 
    RowBox[{"q", "\[Rule]", 
     FractionBox["I1", "I0"]}]}]}],
  HoldForm]], "Input",ExpressionUUID->"5ce91ddc-02d6-4538-9ccb-b5fe9d20de81"],

Cell[BoxData[
 TagBox[
  RowBox[{"expectedKernelExpanded", "=", 
   RowBox[{
    FractionBox[
     TemplateBox[{
       RowBox[{
         RowBox[{"k1", "[", "x", "]"}], " ", 
         RowBox[{"dg", "[", "x", "]"}]}], "x", "xmin", "xmax"},
      "InactiveIntegrate",
      DisplayFunction->(RowBox[{
         SubsuperscriptBox[
          StyleBox["\[Integral]", "Inactive"], #3, #4], 
         RowBox[{#, 
           RowBox[{
             StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
      InterpretationFunction->(RowBox[{
         RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
         RowBox[{#, ",", 
           RowBox[{"{", 
             RowBox[{#2, ",", #3, ",", #4}], "}"}]}], "]"}]& )], "I0"], "-", 
    FractionBox[
     RowBox[{"I1", " ", 
      TemplateBox[{
        RowBox[{
          RowBox[{"k0", "[", "x", "]"}], " ", 
          RowBox[{"dg", "[", "x", "]"}]}], "x", "xmin", "xmax"},
       "InactiveIntegrate",
       DisplayFunction->(RowBox[{
          SubsuperscriptBox[
           StyleBox["\[Integral]", "Inactive"], #3, #4], 
          RowBox[{#, 
            RowBox[{
              StyleBox["\[DifferentialD]", "Inactive"], #2}]}]}]& ),
       InterpretationFunction->(RowBox[{
          RowBox[{"Inactive", "[", "Integrate", "]"}], "[", 
          RowBox[{#, ",", 
            RowBox[{"{", 
              RowBox[{#2, ",", #3, ",", #4}], "}"}]}], "]"}]& )]}], 
     SuperscriptBox["I0", "2"]]}]}],
  HoldForm]], "Input",ExpressionUUID->"fe76f33b-e3bf-4d26-a9f2-8a0f7e1ed796"],

Cell[BoxData[
 TagBox[
  RowBox[{"checkB", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"rhsKernel", "\[Equal]", "expectedKernelExpanded"}], "]"}]}],
  HoldForm]], "Input",ExpressionUUID->"29ed1c2f-f44d-48e5-8123-04d71b4a7d69"]
},
FrontEndVersion->"14.3 for Linux x86 (64-bit) (July 8, 2025)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"f1d63cd9-339c-4795-9911-c1816054072f"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 94, 0, 70, "Title",ExpressionUUID->"1c0bb86d-dfff-4645-82da-4688f5f71b22"],
Cell[651, 22, 154, 2, 70, "Text",ExpressionUUID->"f0aa5e52-ac98-40c1-b840-5b57cdea2c86"],
Cell[808, 26, 151, 4, 70, "Input",ExpressionUUID->"680193be-553a-4c77-832e-dd1044d96b41"],
Cell[962, 32, 303, 9, 70, "Input",ExpressionUUID->"3358246c-0d6d-4f30-bd59-84bf195722a8"],
Cell[1268, 43, 271, 8, 70, "Input",ExpressionUUID->"da2e4ddf-083a-48e9-b3af-4082954dccb8"],
Cell[1542, 53, 207, 5, 70, "Input",ExpressionUUID->"755e3124-cb5b-4079-b331-135156394e98"],
Cell[1752, 60, 708, 19, 70, "Input",ExpressionUUID->"a57e71a3-a83a-42c1-9535-ce34adf7cb0f"],
Cell[2463, 81, 708, 19, 70, "Input",ExpressionUUID->"578559cd-9bf1-4d4e-8f8e-3684b5356ff0"],
Cell[3174, 102, 239, 6, 70, "Input",ExpressionUUID->"5ce91ddc-02d6-4538-9ccb-b5fe9d20de81"],
Cell[3416, 110, 1512, 40, 70, "Input",ExpressionUUID->"fe76f33b-e3bf-4d26-a9f2-8a0f7e1ed796"],
Cell[4931, 152, 229, 5, 70, "Input",ExpressionUUID->"29ed1c2f-f44d-48e5-8123-04d71b4a7d69"]
}
]
*)

(* End of internal cache information *)
